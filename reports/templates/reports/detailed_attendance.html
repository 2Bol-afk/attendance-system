{% extends 'teacherbase.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/report.css' %}">

<div class="dashboard-container">

  <div class="dashboard-header">
    <h2>Detailed Attendance Report</h2>
  </div>

  <!-- Filters -->
  <form method="get" class="filter-form mb-4">
    <div class="form-group">
        <label>Subject</label>
        <select name="subject">
          <option value="">All Subjects</option>
          {% for id, name in subjects %}
            <option value="{{ id }}" {% if subject_filter == id|stringformat:"s" %}selected{% endif %}>{{ name }}</option>
          {% endfor %}
        </select>
    </div>

    <div class="form-group">
        <label>Year</label>
        <select name="year">
          <option value="">All Years</option>
          {% for y in years %}
            <option value="{{ y }}" {% if year_filter == y %}selected{% endif %}>{{ y }}</option>
          {% endfor %}
        </select>
    </div>

    <div class="form-group">
        <label>Section</label>
        <select name="section">
          <option value="">All Sections</option>
          {% for value, display in sections %}
            <option value="{{ value }}" {% if section_filter == value %}selected{% endif %}>{{ display }}</option>
          {% endfor %}
        </select>
    </div>

    <div class="form-group">
        <label>Date From</label>
        <input type="date" name="start_date" value="{{ start_date }}">
    </div>
    <div class="form-group">
        <label>Date To</label>
        <input type="date" name="end_date" value="{{ end_date }}">
    </div>

    <div class="form-group">
        <label>Search Student</label>
        <input type="text" name="search_name" value="{{ search_name }}" placeholder="Enter student name">
    </div>

    <div class="form-group filter-button">
        <button type="submit" class="add-student-btn">Filter</button>
    </div>
  </form>

  <!-- Attendance Table -->
  <div class="attendance-box">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Student Full Name</th>
            <th>Subject</th>
            <th>Date</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for row in data %}
          <tr>
            <td>{{ row.student }}</td>
            <td>{{ row.subject }}</td>
            <td>{{ row.date }}</td>
            <td>{{ row.status }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4">No data found.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
  </div>

</div>
{% endblock %}
